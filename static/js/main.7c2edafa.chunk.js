(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{150:function(e,t,n){e.exports=n(335)},155:function(e,t,n){},324:function(e,t){},334:function(e,t,n){},335:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(142),u=n.n(o),i=(n(155),n(156),n(73)),d=n(74),c=n(149),l=n(143),s=n(148),f=n(52),v=(n(332),n(333),n(334),n(336)),y=n(338),h=n(76),p=n(58),m=n.n(p);var g,E=a.a.memo(function(e){var t=Object(r.useRef)(null);return Object(r.useLayoutEffect)(function(){var n=t.current;if(null!=n){var r=Object.assign({settingsId:e.rootId},e.opts),a=m()(n).PowerGrid(r),o=e.events;if(o){var u=!0,i=!1,d=void 0;try{for(var c,l=o[Symbol.iterator]();!(u=(c=l.next()).done);u=!0){var s=c.value;a.target.on(s.name,s.action)}}catch(f){i=!0,d=f}finally{try{u||null==l.return||l.return()}finally{if(i)throw d}}}e.onGridMounted&&e.onGridMounted(a)}},[]),a.a.createElement("div",{id:e.rootId,style:e.style,className:e.className,ref:t})},function(){return!0}),b=function(){function e(t){Object(i.a)(this,e),this.data=void 0,this.lookupById=void 0,this.handleValueChanged=void 0,this.data=t,this.lookupById=this.computeLookupById(t)}return Object(d.a)(e,[{key:"onValueChanged",value:function(e){this.handleValueChanged=e}},{key:"updateData",value:function(e){var t=this.data;this.data=e,this.lookupById=this.computeLookupById(e),m()(this).trigger("datachanged",{data:e,oldData:t})}},{key:"recordCount",value:function(){return this.data.length}},{key:"getData",value:function(e,t){return this.data.slice(e,t)}},{key:"setValue",value:function(e,t,n){this.getRecordById(e)[t]=n,this.handleValueChanged&&this.handleValueChanged(e,t,n)}},{key:"getRecordById",value:function(e){var t=this.lookupById.get(e);return this.data[t]}},{key:"isReady",value:function(){return!0}},{key:"assertReady",value:function(){if(!this.isReady())throw"Datasource not ready yet"}},{key:"computeLookupById",value:function(e){for(var t=new Map,n=0,r=e.length;n<r;++n)t.set(e[n].id,n);return t}}]),e}();function O(e){var t=e.gridId,n=e.extensions,o=e.opts,u=e.data,i=e.onValueChanged,d=e.onSelectionChanged,c=Object(r.useRef)(null);var l=function(){var e=c.current;if(null!=e)return e;var t={onRowSelected:d};return e={extsContext:t,pgExtensions:function(e,t){var n={};return e.selection&&function(e,t){e.selection={onrowselected:function(e,n){t.onRowSelected&&t.onRowSelected(""+n)}}}(n,t),e.editing&&(n.editing=!0),n}(n,t),dataSource:new b(u)},c.current=e,e}(),s=l.dataSource,f=l.extsContext,v=l.pgExtensions;Object(r.useEffect)(function(){s.updateData(u)},[u]),Object(r.useEffect)(function(){s.onValueChanged(i)},[i]),Object(r.useEffect)(function(){f.onRowSelected=d},[d]);var y=t,p=Object(h.a)({},o,{rootId:y,dataSource:s,extensions:v});return a.a.createElement(E,{rootId:t,opts:p})}function _(e,t,n){var r=[],a=0,o=!0,u=!1,i=void 0;try{for(var d,c=function(){var e=d.value,o=n.map(function(t){return e[t._key]});o.id=t(e,a++),r.push(o)},l=e[Symbol.iterator]();!(o=(d=l.next()).done);o=!0)c()}catch(s){u=!0,i=s}finally{try{o||null==l.return||l.return()}finally{if(u)throw i}}return r}!function(e){e.SET_FORM_VALUE="core.form.SET_FORM_VALUE",e.RESET_ALL_FORM_VALUES="core.form.RESET_ALL_FORM_VALUES",e.RESET_FORM_VALUES="core.form.RESET_FORM_VALUES"}(g||(g={}));var k=n(147),w=n(23);function S(e){var t,n,r=function(e){var t=Object.keys(e),n=[],r=new Set;for(;t.length;){for(var a=void 0,o=0;o<t.length;o++){var u=t[o],i=e[u];"object"===typeof i&&i.dependsOn&&i.dependsOn.some(function(e){return!(e instanceof Function)&&!r.has(e)})?(a||(a=[]),a.push(u)):(n.push(u),r.add(u))}if(!a)break;if(a.length===t.length)throw new Error("cyclic dependency! Couldn't resolve keys: - "+a);t=a}return n}(e),a=new Map;return function(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.a(),i={},d=null==t,c=!0,l=!1,s=void 0;try{for(var f,v=r[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var y=f.value;if(!u.has(y)||null!=n&&n.has(y)&&u.get(y)===n.get(y)){var h=e[y];if(h instanceof Function)i[y]=h(o);else{var p=h.dependsOn;if(p){var m=p.length,g=a.get(y);null==g&&(g=new Array(m),a.set(y,g));for(var E=null==t,b=0;b<m;++b){var O=p[b],_=void 0;_=O instanceof Function?O(o):i[O],g.hasOwnProperty(b)&&g[b]===_||(g[b]=_,E=!0)}i[y]=null==t||E?h.value.apply(h,[o].concat(Object(k.a)(g))):t[y]}else i[y]=h.value(o)}}else i[y]=u.get(y),d=!0;null!=t&&i[y]===t[y]||(d=!0)}}catch(S){l=!0,s=S}finally{try{c||null==v.return||v.return()}finally{if(l)throw s}}return n=u,d?t=i:t}}var I=a.a.memo(function(e){var t=e.formModel;return(0,e.children)(t)});var C,V=Object(f.b)(function(e,t){var n=t.formId,r=t.providers,a=t.selectState,o=S(r);return function(e){var t=function(e,t){var n=e.get("forms").get(t);return n?n.get("values"):Object(w.a)()}(a(e),n);return{providedValues:o(e,t)}}},{setFormValue:function(e,t,n){return{type:g.SET_FORM_VALUE,formId:e,key:t,value:n}},resetAllFormValues:function(e){return{type:g.RESET_ALL_FORM_VALUES,formId:e}}})(function(e){var t=e.children,n=e.formId,o=e.values,u=e.resetAllFormValues,i=e.setFormValue,d=e.providedValues,c=Object(r.useMemo)(function(){return Object.assign({},o,d)},[o,d]),l=Object(r.useMemo)(function(){return{setValue:i.bind(null,n),resetAllValues:u.bind(null,n)}},[n,c,i,u]),s=Object(r.useMemo)(function(){return{formId:n,values:c,actions:l}},[n,c,l]);return a.a.createElement(I,{children:t,formModel:s})}),j=n(337);function A(e){var t=!e.onChanged;return a.a.createElement(j.a.Control,{type:"text",value:e.value,disabled:t,onChange:function(t){e.onChanged&&e.onChanged(t.target.value)}})}function R(e){var t=e.options,n=t.findIndex(function(t){return t.value===e.value}),r=!e.onChanged;return a.a.createElement(j.a.Control,{as:"select",value:""+n,disabled:r,onChange:function(n){e.onChanged&&e.onChanged(t[n.target.value].value)}},t.map(function(e,t){return a.a.createElement("option",{key:t,value:""+t},e.label)}))}function q(e){var t=e.label,n=e.children;return a.a.createElement(j.a.Group,null,a.a.createElement(j.a.Label,null,t),n)}(C||(C={})).SET_CHANGED_QUANTITY="example.SET_CHANGED_QUANTITY";var T=[{_key:"id",width:160,title:"Id"},{_key:"quantity",width:150,title:"Quantity"},{_key:"date",width:150,title:"Date"},{_key:"remark",width:150,title:"Remark"}],L=[{_key:"id",width:160,title:"Id"},{_key:"quantity",width:150,title:"Quantity",editable:!0}],M={products:function(e){return e.data.products},productNo:{value:function(e,t){return t[0].no},dependsOn:["products"]},productDescription:{value:function(e,t,n){var r=n.find(function(e){return e.no===t});return r?r.description:""},dependsOn:["productNo","products"]},data:{value:function(e,t){return _(e.data.salesOrders[t],function(e){return e.id},T)},dependsOn:["productNo"]},selectedId:{value:function(){return""},dependsOn:["data"]},data2:{value:function(e,t,n){var r=t&&e.data.forecasts[t]?_(e.data.forecasts[t],function(e){return e.id},L):[],a=!0,o=!1,u=void 0;try{for(var i,d=r[Symbol.iterator]();!(a=(i=d.next()).done);a=!0){var c=i.value,l=n.get(c[0]);null!=l&&(c[1]=l)}}catch(s){o=!0,u=s}finally{try{a||null==d.return||d.return()}finally{if(o)throw u}}return r},dependsOn:["selectedId",function(e){return e.data.changedQuantities}]},totalQuantity:{value:function(e,t){return t.reduce(function(e,t){return e+parseFloat(t[1])},0)},dependsOn:["data2"]}};var F=Object(f.b)()(function(e){var t=e.dispatch;return a.a.createElement(V,{formId:"form-1",providers:M,selectState:function(e){return e.form}},function(e){var n=e.values,o=e.actions,u=Object(r.useMemo)(function(){return n.products.map(function(e){return{label:e.name,value:e.no}})},[n.products]);return a.a.createElement(v.a,null,a.a.createElement(y.a,{onClick:function(){return o.resetAllValues()}},"Reset"),a.a.createElement(q,{label:"Product no"},a.a.createElement(R,{value:n.productNo,options:u,onChanged:function(e){return o.setValue("productNo",e)}})),a.a.createElement(q,{label:"Product Description"},a.a.createElement(A,{value:n.productDescription,onChanged:function(e){return o.setValue("productDescription",e)}})),a.a.createElement(O,{gridId:"grid-1",data:n.data,opts:{columns:T},extensions:{selection:!0},onSelectionChanged:function(e){return o.setValue("selectedId",e)}}),a.a.createElement(q,{label:"Selected Id"},a.a.createElement(A,{value:n.selectedId,onChanged:function(e){return o.setValue("selectedId",e)}})),a.a.createElement(q,{label:"Total"},a.a.createElement(A,{value:""+n.totalQuantity})),a.a.createElement(O,{gridId:"grid-2",data:n.data2,onValueChanged:function(e,n,r){return t(function(e,t){return{type:C.SET_CHANGED_QUANTITY,id:e,quantity:t}}(e,parseFloat(r)))},opts:{columns:L},extensions:{editing:!0}}))})}),x=n(59),N=Object(w.b)({forms:Object(w.a)()}),D=Object(w.b)({values:Object(w.a)()});function B(e,t,n){return e.update("forms",function(e){return e.update(t,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return n(e)})})}var U={products:[{name:"Product A",no:"1",description:"product A description"},{name:"Product B",no:"2",description:"product B description"},{name:"Product C",no:"3",description:"product C description"}],salesOrders:{1:[{id:"a",date:"01/01-2019",quantity:1,remark:"product A - order 1"},{id:"b",date:"02/01-2019",quantity:2,remark:"product A - order 2"},{id:"c",date:"03/01-2019",quantity:2,remark:"product A - order 3"}],2:[{id:"d",date:"01/01-2019",quantity:1,remark:"product B - order 4"},{id:"e",date:"02/01-2019",quantity:2,remark:"product B - order 5"},{id:"f",date:"03/01-2019",quantity:4,remark:"product B - order 6"},{id:"g",date:"04/01-2019",quantity:8,remark:"product B - order 7"}],3:[{id:"h",date:"01/01-2019",quantity:1,remark:"product C - order 8"}]},forecasts:{a:[{id:"a1",quantity:1},{id:"a2",quantity:2}],b:[{id:"b1",quantity:3},{id:"b2",quantity:4}],c:[{id:"c1",quantity:5},{id:"c2",quantity:6},{id:"c3",quantity:7},{id:"c4",quantity:8}],d:[{id:"d1",quantity:9},{id:"d2",quantity:10}],e:[{id:"d1",quantity:11}],f:[{id:"f1",quantity:12},{id:"f2",quantity:13}],g:[{id:"g1",quantity:14},{id:"g2",quantity:15},{id:"g3",quantity:16},{id:"g4",quantity:17}],h:[{id:"h1",quantity:18},{id:"h2",quantity:19}]},changedQuantities:Object(w.a)()};var Q=Object(x.c)(Object(x.b)({form:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g.SET_FORM_VALUE:return function(e,t){var n=t.formId,r=t.key,a=t.value;return B(e,n,function(e){return e.update("values",function(e){return e.set(r,a)})})}(e,t);case g.RESET_ALL_FORM_VALUES:return function(e,t){var n=t.formId;return B(e,n,function(e){return e.delete("values")})}(e,t);case g.RESET_FORM_VALUES:return function(e,t){var n=t.formId,r=t.keys;return B(e,n,function(e){return e.update("values",function(e){return e.withMutations(function(e){var t=!0,n=!1,a=void 0;try{for(var o,u=r[Symbol.iterator]();!(t=(o=u.next()).done);t=!0){var i=o.value;e.delete(i)}}catch(d){n=!0,a=d}finally{try{t||null==u.return||u.return()}finally{if(n)throw a}}})})})}(e,t);default:return e}},data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.SET_CHANGED_QUANTITY:return function(e,t){var n=t.id,r=t.quantity,a=e.changedQuantities.set(n,r);return Object(h.a)({},e,{changedQuantities:a})}(e,t)}return e}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),G=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return a.a.createElement(f.a,{store:Q},a.a.createElement(F,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(a.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[150,1,2]]]);
//# sourceMappingURL=main.7c2edafa.chunk.js.map